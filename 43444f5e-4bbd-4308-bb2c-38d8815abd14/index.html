<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>自己的自己</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="created: 2022-10-24 05:56:52updated: 2022-11-09 16:23:12tags:   Note&#x2F;Obsidian Note&#x2F;Note Note&#x2F;Article Published Blogid: 43444f5e-4bbd-4308-bb2c-38d8815abd14password: mikemessiabstract:">
<meta property="og:type" content="article">
<meta property="og:title" content="自己的自己">
<meta property="og:url" content="https://zji.me/43444f5e-4bbd-4308-bb2c-38d8815abd14/">
<meta property="og:site_name" content="自己的自己">
<meta property="og:description" content="created: 2022-10-24 05:56:52updated: 2022-11-09 16:23:12tags:   Note&#x2F;Obsidian Note&#x2F;Note Note&#x2F;Article Published Blogid: 43444f5e-4bbd-4308-bb2c-38d8815abd14password: mikemessiabstract:">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-11-09T08:31:58.823Z">
<meta property="article:modified_time" content="2022-11-09T08:55:29.229Z">
<meta property="article:author" content="稻米鼠">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="自己的自己" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">自己的自己</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">怎么办怎么办，老鼠是笨蛋！</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://zji.me"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-43444f5e-4bbd-4308-bb2c-38d8815abd14" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/43444f5e-4bbd-4308-bb2c-38d8815abd14/" class="article-date">
  <time class="dt-published" datetime="2022-11-09T08:31:58.823Z" itemprop="datePublished">2022-11-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<p>created: 2022-10-24 05:56:52<br>updated: 2022-11-09 16:23:12<br>tags: </p>
<ul>
<li>Note&#x2F;Obsidian</li>
<li>Note&#x2F;Note</li>
<li>Note&#x2F;Article</li>
<li>Published</li>
<li>Blog<br>id: 43444f5e-4bbd-4308-bb2c-38d8815abd14<br>password: mikemessi<br>abstract: 这是一篇付费文章，请在 <a href="https://afdian.net/item?plan_id=e808efe84f7a11ed86ec52540025c377" target="_blank">爱发电</a> 购买后用密码解锁。<br>message: 这是一篇付费文章，请在 <a target="_blank" rel="noopener" href="https://afdian.net/a/daomishu">https://afdian.net/a/daomishu</a> 进行购买。<br>wrong_pass_message: 抱歉, 这个密码看着不太对, 请再试试.<br>wrong_hash_message: 抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.<br>title: 0035 把收藏夹装进笔记-Dataview<br>date: 2022-10-24 05:56:52<br>–$1</li>
</ul>
<blockquote>
<ul>
<li><a target="_blank" rel="noopener" href="https://meta.appinn.net/t/topic/37042">《遇见 Obsidian》系列笔记汇总目录</a></li>
<li>如果觉得有用就支持一下作者：[老鼠爱发电](<a target="_blank" rel="noopener" href="https://afdian.net/@daomishu$1">https://afdian.net/@daomishu$1</a></li>
</ul>
</blockquote>
<span id="more"></span>

<p>–$1</p>
<h3 id="效果展-1"><a href="#效果展-1" class="headerlink" title="效果展$1"></a>效果展$1</h3><p>![super-bookmarks.png](<a target="_blank" rel="noopener" href="https://global.cdn.blingwang.cn/2022/10/26/635894d27d8e1.png$1">https://global.cdn.blingwang.cn/2022/10/26/635894d27d8e1.png$1</a></p>
<p>在使用时鼠标放在缩略图上可以显示标签描述。（不是放在上面的效果图$1</p>
<p>点击分类标题可以展开和折叠$1</p>
<h3 id="讲在前-1"><a href="#讲在前-1" class="headerlink" title="讲在前$1"></a>讲在前$1</h3><p>这是一篇长文，我想讲的废话挺多的，代码挺长的，建议使用<a target="_blank" rel="noopener" href="https://simpread.pro/">简悦</a>辅助阅读，这样代码有高亮$1</p>
<p>以下，可能让你失望$1</p>
<ul>
<li>这不是自动化的，但我写了一些辅助脚本，但得会用脚本</li>
<li>代码挺多的，好在只需要复制粘贴，但是得放对地方</li>
<li>效果不完美，我只维护对默认主题的兼容性，其他主题下……千奇百怪$1</li>
</ul>
<h3 id="为什-1"><a href="#为什-1" class="headerlink" title="为什$1"></a>为什$1</h3><p>这是不是无聊或者炫技或者瞎折腾？如果你只是觉得好看，想要，那大概就是了$1</p>
<p>我看了看我自己二百多书签，日常用的不超过二十个。失效的十几个。其他的各式各样的情况，临时收藏，作为资料收藏的，作为工具收集的……和笔记一样的问题：我自己都不记得有什么了$1</p>
<p><strong>笔记是需要整理的</strong>$1</p>
<p>作为资料收藏的，作为工具收集的——这些具有类似笔记的性质。如果是资料，应该通过摘抄使之长期化，避免遗失。如果是工具，应该写清楚描述，编入索引$1</p>
<p>而且，为什么大量不常用的书签要放在浏览器里？如果这不是必要的，而这些信息又不应该被丢弃，那么整理进笔记是一件很合理的事情$1</p>
<p>至于外观，只是恰巧会，所以做了，只是表象，无足轻重$1</p>
<h3 id="思-1"><a href="#思-1" class="headerlink" title="思$1"></a>思$1</h3><p>笔记作为数据源，用 Dataview 将数据渲染为比较美观的格式$1</p>
<p>这里问题很多，毕竟只是笔记，别把期望设定的太高$1</p>
<p>如果按照 Dataview 的设计思路，应该一个书签保存为一篇笔记，这会带来很多好处，比如代码好写等等。但是，大量小文件应该会有性能问题，长期考虑这不太好。而且，也不方便创建和维护$1</p>
<p>所以我将数据集中在一个文件中。如果有需要，也可以是几个文件$1</p>
<h3 id="目录结-1"><a href="#目录结-1" class="headerlink" title="目录结$1"></a>目录结$1</h3><pre><code>/
|-- Template
|  |-- view.js
|  |-- view.css
``$1

只是大概描述一下，方便理解。其实真正的要求非常简单$1

&gt; `view.js` 和 `view.css` 放在同一个文件夹里，这两个文件不可以改名。文件夹名称和位置随意，但里面最好不要放其他文$1

### 代$1

&gt; Template/view.j$1

```js
/*
 * @Author          : 稻米鼠
 * @Date            : 2022-10-22 09:48:06
 * @LastEditTime    : 2022-10-26 09:08:32
 * @FilePath        : Template/view.js
 * @Description     : Obsidian Dataview 书签管理自定义视图
 */
/**
 * 获取图标链接
 *
 * @param &#123;string&#125; url
 * @returns &#123;string&#125;
 */
const get_icon = url=&gt; `https://s2.googleusercontent.com/s2/favicons?domain=$&#123; url.replace(/^(https?:\/\/[\w.-]*)(\/.*)?$/,&#39;$1&#39;) &#125;&amp;sz=32`
/**
 * 获取缩略图链接
 *
 * @param &#123;string&#125; url
 * @returns &#123;string&#125;
 */
const get_screenshot = url=&gt; `https://s0.wp.com/mshots/v1/$&#123; encodeURIComponent(url) &#125;?w=320&amp;h=200$1

/** @type &#123;array&#125; 数据源，默认当前页面 */
let pages = [dv.current()]
/** 如果有输入，并且设置了输入页面 */
if(input &amp;&amp; input.pages)&#123;
  /** 不是数组，即单页面，构建数组 */
  pages = input.pages instanceof Array ? input.pages : [ input.pages ]
&#125;
/** @type &#123;array&#125; 用来输出指定章节（分类），一个数组，如果空数组则显示所有章节 */
const sections = input.sections &amp;&amp; input.sections.length ? input.sections : []
/** @type &#123;number&#125; 当前展开的分类序号 */
let unfold = input.unfold ? input.unfold : -1
/** @type &#123;object&#125; 书签数据对象 */
const navs = &#123;&#125;
/** @type &#123;number&#125; 书签总数量 */
let total = $1

/* 查询书签源，并过滤 */
pages.forEach(p=&gt;&#123;
  /** 有子元素的是每个书签的根节点 */
  p.file.lists.filter(e=&gt;e.children.length)
  .forEach(e=&gt;&#123;
    /** @type &#123;string&#125; 章节名称 */
    const section = e.section.subpath
    /** 如果有分类限定，并且当前章节不在其中，则返回 */
    if(sections.length &amp;&amp; !sections.includes(section)) return
    /** 如果当前分组不存在，则创建 */
    if(!navs[section]) navs[section] = []
    /** 解析并存储书签数据 */
    const url = e.children[1].text
    navs[section].push(&#123;
      title: e.text.split(/\n/)[0],
      desc: e.children[0].text,
      url,
      add: e.children[2].text,
      screenshot: e.children[3] ? e.children[3].text : get_screenshot(url),
      icon: e.children[4] ? e.children[4].text : get_icon(url),
      link: e.path+(e.blockId ? &#39;#^&#39;+e.blockId : &#39;&#39;),
    &#125;)
    /** 书签总数增加 */
    total++
  &#125;)
&#125;)
/** @type &#123;array&#125; 获取分组名称数组，这样可以确保分组顺序一致 */
const groups = Object.keys(navs)
/* 整理生成书签页结构代码 */
let code = &#39;&#39;
groups.forEach((group, i)=&gt;&#123;
  code += `&lt;div class=&quot;bookmark-group-title&quot; style=&quot;background-color: hsla($&#123;i*15&#125;, 100%, 50%, .1)&quot;&gt;
    $&#123;group.replace(/^\d+-/, &#39;&#39;)+&#39; (&#39;+navs[group].length+&#39;/&#39;+total+&#39;)&#39;&#125;
    &lt;/div&gt;
    &lt;div class=&quot;bookmark-group&quot;&gt;&lt;/div&gt;`
&#125;)
/** @type &#123;HTMLElement&#125; 创建一个元素，然后把代码塞进去 */
const root = dv.el(&#39;div&#39;, &#39;&#39;, &#123;cls: &#39;bookmark-index&#39;&#125;)
root.innerHTML = cod$1

/**
 * 展开指定分组
 *
 * @param &#123;number&#125; index 要展开的分组序号
 */
const unfoldGroup = index=&gt;&#123;
  unfold = unfold === index ? -1 : index
  root.querySelectorAll(&#39;.bookmark-group&#39;).forEach((group, i)=&gt;&#123;
    if(i!==unfold)&#123;
      group.innerHTML = &#39;&#39;
      return
    &#125;
    let groupCode = &#39;&#39;
    navs[groups[unfold]].forEach(e=&gt;&#123;
      groupCode += `
      &lt;div class=&quot;bookmark-card&quot;&gt;
        &lt;div class=&quot;bookmark-info&quot;&gt;
          &lt;img class=&quot;bookmark-screenshot&quot; src=&quot;$&#123; e.screenshot &#125;&quot;&gt;
          &lt;div class=&quot;bookmark-desc&quot;&gt;$&#123;e.desc&#125;&lt;/div&gt;
        &lt;/div&gt;
        &lt;div class=&quot;bookmark-title&quot;&gt;
          &lt;img class=&quot;bookmark-icon&quot; src=&quot;$&#123; e.icon &#125;&quot;&gt;
          &lt;a class=&quot;bookmark-link&quot; href=&quot;$&#123;e.url&#125;&quot; title=&quot;$&#123;e.title&#125;&quot; target=&quot;_blank&quot;&gt;$&#123;e.title&#125;&lt;/a&gt;
        &lt;/div&gt;
        &lt;div class=&quot;bookmark-url&quot;&gt;
          &lt;a class=&quot;bookmark-link&quot; href=&quot;$&#123;e.url&#125;&quot; title=&quot;$&#123;e.url&#125;&quot; target=&quot;_blank&quot;&gt;$&#123;e.url&#125;&lt;/a&gt;
        &lt;/div&gt;
        &lt;div class=&quot;bookmark-add&quot;&gt;
          Add Time: &lt;a data-href=&quot;$&#123; e.link &#125;&quot; href=&quot;$&#123; e.link &#125;&quot; class=&quot;internal-link bookmark-edit&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;$&#123; e.add &#125;&lt;/a&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      `
    &#125;)
    group.innerHTML = groupCode
  &#125;)
$1

/** 展开默认分组 */
unfoldGroup(unfold$1

/** 给标题添加点击事件 */
root.querySelectorAll(&#39;.bookmark-group-title&#39;).forEach((title, i)=&gt;&#123;
  title.addEventListener(&#39;click&#39;, ()=&gt;&#123; unfoldGroup(i) &#125;)
&#125;)
``$1

&gt; Template/view.cs$1

```css
/*
 * @Author          : 稻米鼠
 * @Date            : 2022-10-22 10:23:17
 * @LastEditTime    : 2022-10-26 09:32:33
 * @FilePath        : Template/view.css
 * @Description     : 书签索引页样式
 *$1

.bookmark-group-title &#123;
  background-color: rgba(0, 0, 0, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 6px;
  box-sizing: border-box;
  cursor: pointer;
  font-size: 1.2em;
  line-height: 1.4em;
  margin: 2px 0;
  text-align: center;
$1

.bookmark-group &#123;
  display: flex;
  align-items: flex-start;
  flex-wrap: wrap;
  justify-content: center;
$1

.bookmark-group * &#123;
  box-sizing: border-box;
$1

.bookmark-card &#123;
  border: 1px solid #9999aa;
  border-radius: 6px;
  flex-shrink: 0;
  height: 280px;
  margin: 10px 5px;
  max-width: 98%;
  overflow: hidden;
  padding: 5px;
  width: 332px;
$1

.bookmark-info &#123;
  position: relative;
  height: 200px;
  margin-bottom: 0.5em;
  overflow: hidden;
  width: 320px;
$1

.bookmark-screenshot &#123;
  height: 200px;
  width: 320px;
$1

.bookmark-desc &#123;
  position: absolute;
  top: -105%;
  left: 0;
  backdrop-filter: blur(18px);
  background-color: rgba(0, 0, 0, 0.6);
  color: #cccccf;
  font-size: 16px;
  height: 100%;
  line-height: 1.6rem;
  overflow: hidden;
  padding: 1em 1.5em;
  transition: top 0.2s;
  width: 100%;
  z-index: 10;
$1

.bookmark-info:hover&gt;.bookmark-desc &#123;
  top: 0;
$1

.bookmark-title,
.bookmark-url,
.bookmark-add &#123;
  font-size: 16px;
  line-height: 1.2rem;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  width: 100%;
$1

.bookmark-card a &#123;
  text-decoration: none;
$1

.bookmark-title&gt;.bookmark-icon &#123;
  display: inline-block;
  height: 1em;
  width: 1em;
$1

.bookmark-title&gt;a.bookmark-link &#123;
  color: var(--text-normal);
  font-weight: 700;
$1

.bookmark-url&gt;a.bookmark-link &#123;
  color: #99999a;
  font-size: 12px;
  font-weight: 200;
$1

.bookmark-add &#123;
  color: #666688;
  font-size: 12px;
  font-weight: 200;
$1

.bookmark-add&gt;a.bookmark-edit &#123;
  color: #666688;
  font-size: 12px;
  font-weight: 200;
  text-decoration: none;
$1

/* 取消内容宽度限制，不一定能起作用 *$1

.markdown-source-view.mod-cm6.is-readable-line-width .cm-sizer,
.markdown-source-view.mod-cm6.is-readable-line-width .cm-content,
.markdown-preview-view.is-readable-line-width .markdown-preview-sizer &#123;
  max-width: none;
&#125;
``$1

以后代码肯定会有更新，所以我把修改时间标记上了，方便对照（谁会在意这些细节）$1

### 数据$1

在任意笔记中用如下格式书写$1

```md
## 001-Communit$1

- 小众软件官方论坛
  ^metaappinnnet #Appinn
  - 讨论一些有趣的话题，你也可以来开分版
  - https://meta.appinn.net/
  - 2022-10-23 12:53:23
- V2EX
  ^v2excom
  - 创意工作者的社区。讨论编程、设计、硬件、游戏等令人激动的话题。
  - https://www.v2ex.com/
  - 2022-10-23 12:53:49
  - https://fakeimg.pl/320x200/eae0d0/282832/?text=V2ex&amp;font=lobster
``$1

非常标准的 Markdown 代码，但是作为数据源，要求自然会更严格一点，我们聊聊细节$1

#### 分$1

- 标题代表分组
- 开头的数字和短划线部分不会被显示，仅用作排序，推荐两位或者三位数字，这样可以保证第一位总是 0
- 标题的等级随意，没有层级关$1

#### 书签条$1

- 两级列表，第一级是标题，分为两行
  - 第一行是标题内容
  - 第二行【可选】，如果手动插入使用 Shift+Enter，不显示，用来填写 blockId 和书签
- 第二级有严格的顺序要求
  - 第二级第一条是书签的描述（鼠标在缩略图上悬浮时显示）
  - 第二级第二条是书签的网址
  - 第二级第三条是书签的添加时间
  - 第二级第四条【可选】是网站缩略图的地$1

### 使$1

在任意笔记中加入如下 dataviewjs 代码段$1

```js
await dv.view(&#39;Template&#39;)
``$1

诶，注意细节哦，这里小括号里写的是 `view.js` 所在的文件夹（路径），根据你自己的情况修改好$1

好了，当然，但是可能什么都没有，因为没有告知数据源。（默认数据源是当前笔记$1

### 指定数据$1

上面的写法会使用代码块所在的笔记作为数据源。但不推荐这么用，因为在实时预览状态下编辑会狂闪（每一次改变都触发重新渲染）$1

```js
await dv.view(&#39;Template&#39;, &#123;pages: dv.pages(&#39;&quot;Bookmarks&quot;&#39;)&#125;)
``$1

这样就以 `Bookmarks` 目录下的所有笔记作为数据源了。这里可以使用 `dv.pages()` 和 `dv.page()` 两种查询方式来指定数据源，详细可以参考： https://blacksmithgu.github.io/obsidian-dataview/api/code-reference/#dvpagessourc$1

上面代码是指定文件夹，注意：就是两层引号，不是写错了$1

下面是以指定标签的笔记作为数据源$1

```js
await dv.view(&#39;Template&#39;, &#123;pages: dv.pages(&#39;#Bookmarks&#39;)&#125;)
``$1

下面是以特定的某一篇笔记作为数据源$1

```js
await dv.view(&#39;Template&#39;, &#123;pages: dv.page(&#39;Bookmarks/source&#39;)&#125;)
``$1

### 更多参$1

上面第二个参数是一个对象，其实具有三个可选属性$1

- `pages`：@typeof &#123;Array&#125; 要显示的笔记
- `sections`：@typeof &#123;Array&#125; 要显示的分组名称（使用完整的章节标题进行比对）
- `unfold`：@typeof &#123;Number&#125; 展开的分组序号，默认为 -1，即全不展$1

### 使用细$1

#### 没成功就重启试$1

你把代码复制过去了，确认一毛钱错误都没有，但是似乎有问题。——重启 Obsidian 试试$1

使用自定义视图（`view.js`、`view.css`）方式可能因为这两个文件没能及时重新加载而出现一些问题，一般来说关闭当前笔记再打开即可，如果不好使，重启软件试试$1

#### 关于缩略$1

缩略图和网站图标都是用在线 Api 获取的。我不知道怎么保存到本地，我尝试了，大概我也能搞出来，但是代码复杂度和运算量都有提升，感觉不值的。（后面看具体情况可能会搞一下，但感觉意义不大，反正 Api 还算挺好用$1

部分网站无法正确获取缩略图，比如 V2ex，这时候可以自己设定缩略图。可以参照我写这个占位图$1

因为使用 Api，就要注意请求量不要过大，所以最好一组内容一个文件，而不是全放在一起显示。虽然我测试下二百多条也没啥压力，但是何必呢$1

第一次获取缩略图可能全是转圈圈，等一会儿，然后关闭重新打开笔记可能就好了$1

获取网站图标的 Api 是狗哥家的，所以你懂的。反正 Wordpress 家的也未必好到哪儿去$1

#### 关于 blockI$1

这个是为了快速定位到对应的数据源而设定的，在展示页面（笔记）中，点击每个书签底下的添加时间就可以快速跳转到对应的位置，方便修改书签$1

后面的自动生成方法中，blockId 都是直接用的网址中的字符，所以如果网址很长，blockId 也会很长，如果介意自行修改一下。毕竟用别的条件自动生成有可能导致重复$1

#### 关于性能优$1

数据都在一个文件（源）里，这样不使用的时候，以及同步数据的时候都比较友好。如果数据量太大可以分文件存储$1

展示时折叠的分组代码会被卸载，所以默认所有分组折叠，其实只是显示了一下标题。这样只要合理分组，就不会一次展示太多内容$1

然后也可以设定当前页要展示的分组$1

### 导入浏览器书$1

先把浏览器里的书签导出为 html 文件，然后在浏览器里打开这个文件，在终端（浏览器——开发者工具（F12）——Console（终端））里运行如下代码$1

```js
/*
 * @Author          : 稻米鼠
 * @Date            : 2022-10-22 15:00:16
 * @LastEditTime    : 2022-10-23 13:16:48
 * @FilePath        : \Obsidian\Notes\Bookmarks\Tools\导出书签转换为Markdown代码.js
 * @Description     : 
 */
/** @type &#123;Object&#125; 书签数据对象 */
const bookmarks = &#123;&#125;
/** @type &#123;String&#125; 当前组 */
let nowGroup
/**
 * 设定当前组
 *
 * @param &#123;String&#125; name
 */
const setGroup = name=&gt;&#123;
  nowGroup = name
  if(!bookmarks[name]) bookmarks[name] = []
&#125;
/**
 * 保存书签项
 *
 * @param &#123;HTMLLinkElement&#125; e 链接元素
 */
const saveItem = e=&gt;&#123;
  bookmarks[nowGroup].push(&#123;
    title: e.innerText,
    url: e.href,
    add: new Date( Number(e.getAttribute(&#39;add_date&#39;))*1e3).toLocaleString().replace(/T.*$/, &#39;&#39;).replace(/\//g, &#39;-&#39;),
    // icon: e.getAttribute(&#39;icon&#39;) /* 网站图标，base64 字符串，我嫌数据多，省略 */
  &#125;)
&#125;
/**
 * 获取所属文件夹
 *
 * @param &#123;HTMLLinkElement&#125; e 链接元素
 * @param &#123;Array&#125; [folders=[]] 所属分类文件夹
 * @return &#123;String&#125; 分类字符串
 */
const getGroup = (e, folders=[])=&gt;&#123;
  if(e.tagName===&#39;DT&#39; &amp;&amp; e.children[0].tagName ===&#39;H3&#39; )&#123; folders.unshift(e.children[0].innerText) &#125;
  const parent = e.parentElement
  if(parent.tagName===&#39;BODY&#39; || parent.tagName===&#39;HTML&#39; || !parent) return folders.length ? folders.join(&#39;-&#39;) : &#39;Other&#39;
  return getGroup(parent, folders)
&#125;
/** 从文件夹标题开始遍历 */
document.body.querySelectorAll(&#39;a&#39;).forEach(e=&gt;&#123;
  setGroup(getGroup(e))
  saveItem(e)
&#125;)
/**
 * 以上可以的到 bookmarks, 可以整理为 JSON
 * 上面的整理方式丢失了文件夹的创建和更新时间，大概没人需要
 * ==================
 * 以下整理为 Markdown 格式
 * 文件夹直接平铺展开，因为没必要复杂的层级结构
 * 因为文件夹名称是按层级拼接而成，所以如有需要，可以自行还原
 * ==================
 * 下面数据中用了两次 e.title
 * 第一次的信息日后用作这个书签的标题
 * 而第二次（缩进）的信息用作这个书签的描述
 */
let markdownCode = &#39;&#39;
for(const group in bookmarks)&#123;
  markdownCode += &#39;## &#39;+group+&#39;\n\n&#39;
  bookmarks[group].forEach(e=&gt;&#123;
      markdownCode += &#39;- &#39;+e.title+&#39;\n&#39;
      markdownCode += &#39;  ^&#39;+e.url.replace(/^https?:\/\/(www\.)?/, &#39;&#39;).replace(/\W/g, &#39;&#39;)+&#39;\n&#39;
      markdownCode += &#39;  - &#39;+e.title+&#39;\n&#39;
      markdownCode += &#39;  - &#39;+e.url+&#39;\n&#39;
      markdownCode += &#39;  - &#39;+e.add+&#39;\n&#39;
  &#125;)
  markdownCode += &#39;\n&#39;
&#125;
/** 输出 */
console.log(markdownCode)
``$1

然后就可以复制到生成好的 markdown 代码了。其中书签文件夹被扁平化了（是这么讲吧，我不擅长这种名词），反正试试就知道了。我用 Chrome 导出的文件搞的，其他浏览器的没测试$1

### 添$1

我本来是想用 QuickAdd 的，但是需要添加的信息稍微有点复杂，手动填表太烦了，就写了个小书签$1

```js
javascript:(function () &#123;
const copyText = text =&gt; &#123;
  const textArea = document.createElement(&#39;textarea&#39;);
  textArea.setAttribute(&#39;readonly&#39;, &#39;readonly&#39;);
  textArea.value = text;
  document.body.appendChild(textArea);
  textArea.select();
  document.execCommand(&#39;copy&#39;);
  document.body.removeChild(textArea);
&#125;;
const title = document.title;
const url = window.location.href;
const blockId = url.replace(/^https?:\/\/(www\.)?/, &#39;&#39;).replace(/\W/g, &#39;&#39;);
const desc = document.querySelector(&#39;meta[name=&quot;description&quot;]&#39;) ? document.querySelector(&#39;meta[name=&quot;description&quot;]&#39;).content : title;
const content = `- $&#123;title&#125;\n`
  + `  ^$&#123;blockId&#125;\n`
  + `  - $&#123;desc&#125;\n`
  + `  - $&#123;url&#125;\n`
  + `  - $&#123;new Date().toLocaleString().replace(/T.*$/, &#39;&#39;).replace(/\//g, &#39;-&#39;)&#125;\n`;
try &#123;
  copyText(content);
  alert(&#39;复制成功！&#39;);
&#125; catch (error) &#123;
  console.log(content);
  alert(&#39;复制失败，已尝试输出到控制台（Console）&#39;);
&#125;
&#125;)($1

``$1

反正就是打开网站，点一下小书签，代码就复制到剪切板里了$1
</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://zji.me/43444f5e-4bbd-4308-bb2c-38d8815abd14/" data-id="cla9eor6x001up0odcj9a6a6p" data-title="" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/6fc1b09c-90bf-4904-bd3a-4599c7a0eb26/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">前一篇</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/7857e9c1-dc7b-42f2-949a-6f0fb397b6df/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">后一篇</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">十一月 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/567af6da-0ca5-44bb-9c60-dbe9295dbef8/">(no title)</a>
          </li>
        
          <li>
            <a href="/1bd1f7c0-a822-43b7-922f-7483ef75ff23/">(no title)</a>
          </li>
        
          <li>
            <a href="/890cb87f-69d6-4f7c-b8b4-b4b9c4fbc1f0/">(no title)</a>
          </li>
        
          <li>
            <a href="/edd8138a-db50-42e4-8a9c-6863193716e7/">(no title)</a>
          </li>
        
          <li>
            <a href="/9f2aed66-7b1d-4601-9eb0-3b4ef5bdbaac/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 稻米鼠<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>